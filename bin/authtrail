#!/usr/bin/env ruby

# frozen_string_literal: true

require 'dry/cli'

require_relative '../app'

module Authtrail
  class Cli
    extend Dry::CLI::Registry

    class Serve < Dry::CLI::Command
      desc "start dev server"

      argument :port, desc: 'port in which you want to run your server on default 3000'

      def call(port: 4567, **)
        system "ruby server/server.rb"
      end
    end

    class Specs < Dry::CLI::Command
      desc "run tests"
      def call(**)
        system 'bundle exec rspec'
      end
    end

    register 'serve', Serve
    register 'specs', Specs
  end
end


Dry::CLI.new(Authtrail::Cli).call
